<html>
<body>
<style>
canvas {
	transform: scale(-1, 1);
}
</style>

<script src="../builds/artoolkit.js"></script>
<script src="common.js"></script>
<script src="artk_demos/js/third_party/three.js/three.min.js"></script>
<script src="artk_demos/js/artoolkit.three.js"></script>

<script>

ARController.getUserMediaThreeScene({width: 720, height: 480, cameraParam: '/bin/Data/camera_para.dat', onSuccess: function(arScene, arController, arCamera) {

	arController.setPatternDetectionMode(artoolkit.CONSTANTS.AR_MATRIX_CODE_DETECTION);

	var renderer = new THREE.WebGLRenderer({antialias: true});
	renderer.setSize(arScene.video.videoWidth, arScene.video.videoHeight);

	document.body.appendChild(renderer.domElement);

	// See /doc/patterns/Matrix code 3x3 (72dpi)/20.png
	var markerRoot = arController.createThreeBarcodeMarker(20);

	var sphere = new THREE.Mesh(
		new THREE.SphereGeometry(0.5, 8, 8),
		new THREE.MeshNormalMaterial()
	);
	sphere.material.shading = THREE.FlatShading;
	sphere.position.z = 0.5;
	markerRoot.add(sphere);
	arScene.scene.add(markerRoot);

	var tick = function() {
		arScene.process();
		arScene.renderOn(renderer);

		requestAnimationFrame(tick);
	};

	tick();

}});

</script>

</body>
</html>